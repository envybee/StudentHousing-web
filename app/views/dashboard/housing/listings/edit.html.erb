<!DOCTYPE html>
<html>
  <head>
    <%= stylesheet_link_tag 'dashboard_housing_listings_edit.css'%>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.css">
    <link rel="stylesheet" href="/assets/bootstrap-datepicker/css/datepicker.css">
    <link rel="stylesheet" href="/assets/AdminLTE/dist/css/AdminLTE.min.css">
    <link href="/assets/AdminLTE/dist/css/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <!-- Latest compiled and minified JavaScript -->
  </head>
  <body class="skin-blue sidebar-mini">
    <div id="wrapper">
      
      <%= render 'shared/common_front_nav' %>
    
      <form id="create_listing_form">
        <div class="col-md-12">
            <section class='panel'>
              <section class='panel-body'>
                <div id="map-canvas" style="height:317px;"></div>

                <div id="form-text-wrapper">
                  <h4 id="address_input_label">
                    <i class="fa fa-map-marker"></i>
                      Address
                    </h4>
                  <input id="address_input" name="address_input" class="form-text form-control" type="text" placeholder="Type an address...">
                </div>
              </section>
            </section>
        </div>
          <div class="col-md-8">
            <section class='panel'>
              <section class='panel-body'>
                <div id="form-text-wrapper">
                  <h4>
                  <i class="fa fa-font"></i>
                  Title</h4>
                  <input id="housing_listing_title" name="housing_listing_title" class="form-text form-control" type="text" required>
                </div>
                <div class="col-xs-12">
                  <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-left: 0px;">
                    <h4>
                    <i class="fa fa-bed"></i>
                      Bedrooms
                    </h4>
                    <input id="housing_listing_bedrooms" name="housing_listing_bedrooms" class="form-text form-control" type="text">
                  </div>
                  <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-right: 0px;">
                    <h4>
                    <i class="fa fa-tint"></i>
                      Bathrooms
                    </h4>
                    <input id="housing_listing_bathrooms" name="housing_listing_bathrooms" class="form-text form-control" type="text">
                  </div>
                </div>
                <div class="col-xs-12">
                  <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                    <h4>
                      <i class="fa fa-building-o"></i>
                      Type
                    </h4>
                    <input id="housing_type_checkbox" name="housing_type_checkbox" type="checkbox">
                  </div>
                  <div id="form-text-wrapper" class="col-md-6">
                    <h4>
                      <i class="fa fa-bed"></i>
                      Furniture
                    </h4>
                    <input id="furnished_checkbox" name="furnished_checkbox" type="checkbox">
                  </div>
                </div>
                <div class="col-xs-12">
                  <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                    <h4>
                      <i class="fa fa-wifi"></i>
                      Internet
                    </h4>
                    <input id="internet_checkbox" name="internet_checkbox" type="checkbox">
                  </div>
                  <div id="form-text-wrapper" class="col-md-6">
                    <h4>
                      <i class="fa fa-car"></i>
                      Parking
                    </h4>
                    <input id="parking_checkbox" name="parking_checkbox" type="checkbox">
                  </div>
                </div>
                <div id="more_amenities" style="display:none">
                  <div id="" class="col-xs-12">
                    <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                      <h4>
                        Ensuite Washroom
                      </h4>
                      <input id="ensuite_washroom_checkbox" name="ensuite_washroom_checkbox" type="checkbox">
                    </div>
                    <div id="form-text-wrapper" class="col-md-6">
                      <h4>
                        Washer/Dryer
                      </h4>
                      <input id="washer_dryer_checkbox" name="washer_dryer_checkbox" type="checkbox">
                    </div>
                  </div>
                  <div class="col-xs-12">
                    <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                      <h4>
                        Gym
                      </h4>
                      <input id="gym_checkbox" name="gym_checkbox" type="checkbox">
                    </div>
                    <div id="form-text-wrapper" class="col-md-6">
                      <h4>
                        Pet-friendly
                      </h4>
                      <input id="pet_friendly_checkbox" name="pet_friendly_checkbox" type="checkbox">
                    </div>
                  </div>
                </div>
                <div class="col-xs-12" style="margin-top: 10px;">
                  <button id="more_amenities_btn" class="btn btn-sm btn-success" style="float: right;"><i class="fa fa-plus"></i>
                    <span id="amenities_btn_text">More Amenities</span>
                  </button>
                </div>
                <div class="col-md-12" id="form-text-wrapper" style="padding-left: 0px; padding-right: 0px; margin-top: 15px;">
                  <h4>
                  <i class="fa fa-pencil"></i>
                  Details</h4>
                  <textarea id="housing_listing_details" name="housing_listing_details" class="form-text-area form-control" rows="5" id="details"></textarea>
                </div>
              </section>
            </section>
          </div>
          <div class="col-md-4">
            <section class='panel'>
              <section class='panel-body'>
                <div id="form-text-wrapper">
                  <h4>
                  <i class="fa fa-dollar"></i>
                  Price</h4>
                  <input id="housing_listing_price" name="housing_listing_price" class="form-text form-control" type="text">
                </div>
                <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-left: 0px; margin-top: 13px;">
                  <h4>
                  <i class="fa fa-clock-o"></i>
                  Start Date
                  </h4>
                  <input id="housing_listing_start_date" name="housing_listing_start_date" class="datepicker form-text-area form-control" data-date-format="mm/dd/yyyy">
                </div>
                <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-right: 0px; margin-top: 13px;">
                  <h4>
                  <i class="fa fa-clock-o"></i>
                  End Date
                  </h4>
                  <input id="housing_listing_end_date" name="housing_listing_end_date" class="datepicker form-text-area form-control" data-date-format="mm/dd/yyyy">
                </div>
              </section>
            </section>
          </div>
          <div class="col-md-4 col-sm-12 col-xs-12">
              <section class='panel'>
                <section class='panel-body'>
                  <% if @housing_listing.housing_images.length > 0 %>
                    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                  <% else %>
                    <div id="carousel-example-generic" class="carousel slide">
                  <% end %>
                    <!-- Indicators -->
                    <ol id="carousel_indicators" class="carousel-indicators">
                    <% i = 0%>
                    <% @housing_listing.housing_images.each do |housing_image| %>
                        <% if housing_image == @housing_listing.housing_images.first%>
                      <li data-target="#carousel-example-generic" data-slide-to="<%=i%>" class="active"></li>
                        <% else %>
                      <li data-target="#carousel-example-generic" data-slide-to="<%=i%>"></li>
                        <% end %>
                        <%i = i + 1%>
                    <% end %>
                    </ol>

                    <!-- Wrapper for slides -->
                    <div id="carousel_inner" class="carousel-inner" role="listbox">
                      <% if @housing_listing.housing_images.length > 0%>
                        <% @housing_listing.housing_images.each do |housing_image| %>
                          <% if housing_image == @housing_listing.housing_images.first%>
                          <div class="item active" style="height: 315px;">
                          <% else %>
                          <div class="item" style="height: 315px;">
                          <% end %>
                            <img class="center-block img-responsive" src="<%= housing_image.url %>" alt="..." style="max-height: 315px;"></img>
                            <div class="carousel-caption">
                              <h3><%= housing_image.title %></h3>
                              <p><%= housing_image.description %></p>
                            </div>
                          </div>
                        <% end %>
                      <% else %>
                      <% end %>
                    </div>

                    <% if @housing_listing.housing_images.length > 0%>
                      <!-- Controls -->
                      <a id="carousel_previous" class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                      </a>
                      <a id="carousel_next" class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                      </a>
                    <% else %>
                      <!-- Controls -->
                      <a id="carousel_previous" class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev" style="display:none;">
                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                      </a>
                      <a id="carousel_next" class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next" style="display:none;">
                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                      </a>
                    <% end %>
                  </div>

                  <button id="upload_photos_btn" class="btn btn-sm btn-success" style="width:100%; margin-top: 1%;">Upload photos</button>
                </section>
              </section>
            </div>

            <%= cl_image_upload_tag(:image_id, :html => {'id' => 'photo_upload_submit_btn', 'style' => 'display: none;'}) %>
        </form>
        <div class="col-md-12" style="text-align:center; padding-bottom: 30px; padding-top: 30px;">
          <button id="submit_btn" class="btn btn-success" style="width: 200px; float: right; margin: 5px;">
            Submit
          </button>
          <button id="cancel_btn" class="btn btn-warning" style="width: 200px; float: right; margin: 5px;">
            Cancel
          </button>
        </div>
    </div>
  </body>

  <div class="modal fade" id="publish_diag" tabindex="-1" role="dialog" aria-labelledby="publish_diag_title" aria-hidden="true">
      <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="publish_diag_title">Success!</h4>
          </div>
          <div class="modal-body">
          <p>You have successfully made changes to your ad. You can find it at the following <a href="<%=housing_listing_url(@housing_listing.id)%>" target="_blank">link</a></p>
          </div>
          <div class="modal-footer">
          <button id="publish_confirm" type="button" class="btn btn-primary">Got it!</button>
          </div>
      </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
  </div>

  <div class="modal" id="photos_modal" tabindex="-1" role="dialog" aria-labelledby="login_modal" aria-hidden="true">
      <div class="modal-dialog modal-sm">
          <div class="modal-content">
              <div class="modal-header">
                <h4>Upload photo</h4>
              </div>
              <div class="modal-body">
                <div>
                  Title (Optional)
                  <input id="image_title" class="form-text" type="text">
                </div>
                <div>
                  Description (Optional)
                  <textarea id="image_description" class="form-text-area" rows="5" id="photo_details"></textarea>
                </div>
                <div id="custom_photo_upload_submit_btn" class="btn btn-success" style="width: 100%;">
                  Upload photo
                </div>
              </div>
              
          </div>
      </div>
  </div><!-- end of photos_modal -->

</html>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="/assets/bootstrap-switch-master/dist/js/bootstrap-switch.js"></script>
<script src="/assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="/assets/jquery/jquery.ui.widget.js"></script>
<script src="/assets/jquery/jquery.iframe-transport.js"></script>
<script src="/assets/jquery/jquery.fileupload.js"></script>
<script src="/assets/jquery/jquery.cloudinary.js"></script>
<script src="/assets/AdminLTE/dist/js/app.min.js"></script>

    <%= cloudinary_js_config %>
<script type="text/javascript">
  /*
    VARIABLES FOR SCRIPTS
  */

  var housing_listing_is_active = <%=@housing_listing.active%>;
  if (housing_listing_is_active) {

    var is_furnished_active = <%= ((@housing_setting.furnished == nil) ? 0 : @housing_setting.furnished) %>;
    var rental_active_active = '<%=@housing_setting.rental_type%>';
    var internet_active = <%=@housing_setting.internet%>;
    var parking_active = <%=@housing_setting.parking%>;
    var ensuite_washroom_active = <%=@housing_setting.ensuite_washroom%>;
    var washer_dryer_active = <%=@housing_setting.washer_dryer%>;
    var gym_active = <%=@housing_setting.gym%>;
    var pet_friendly_active = <%=@housing_setting.pet_friendly%>;
    var start_date_active = "<%=@housing_setting.start_date%>";
    var end_date_active = "<%=@housing_setting.end_date%>";
    var address_active = "<%=@housing_listing.address%>";
    var title_active = "<%=@housing_listing.name%>";
    var bedrooms_avail_active = "<%=@housing_setting.rooms_available%>";
    var bathrooms_avail_active = "<%=@housing_setting.num_washrooms%>";
    var price_active = "<%=@housing_listing.price%>";
    var details_active = "<%=@housing_listing.description%>";
  }
  var cloudinary_image_new_api = "<%= api_v1_cloudinary_images_url %>";
  var housing_listing_update_api = "<%= api_v1_housing_listing_url %>";
  var current_housing_listing_id = <%= @housing_listing.id %>;
  var dashboard_index = "<%= dashboard_index_url %>"; 

</script>
<%= javascript_include_tag "/javascripts/dashboard_housing_listings_edit" %>
