<!DOCTYPE html>
<html>
  <head>
    <%= stylesheet_link_tag 'dashboard_housing_listings_edit.css'%>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.css">
    <link rel="stylesheet" href="/assets/bootstrap-datepicker/css/datepicker.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <!-- Latest compiled and minified JavaScript -->
  </head>
  <body>

    <nav class="navbar navbar-default">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
                </div>
          <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
                        <li><a href="#">About</a></li>
                        <% if user_signed_in? %>
                        <li><a href="<%= dashboard_index_path %>">Dashboard</a></li>
            <% else %>
                        <li><a id="sign_in_btn" href="#">Sign in</a></li>
            <% end %>
                    </ul>
                </div>
      </div>
    </nav>
    
    <form id="create_listing_form">
      <div class="col-md-12">
          <section class='panel'>
            <section class='panel-body'>
              <div id="map-canvas" style="height:317px;"></div>

              <div id="form-text-wrapper">
                <h4 id="address_input_label">
                  <i class="fa fa-map-marker"></i>
                    Address
                  </h4>
                <input id="address_input" name="address_input" class="form-text form-control" type="text" placeholder="Type an address...">
              </div>
            </section>
          </section>
      </div>
        <div class="col-md-8">
          <section class='panel'>
            <section class='panel-body'>
              <div id="form-text-wrapper">
                <h4>
                <i class="fa fa-font"></i>
                Title</h4>
                <input id="housing_listing_title" name="housing_listing_title" class="form-text form-control" type="text" required>
              </div>
              <div class="col-xs-12">
                <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-left: 0px;">
                  <h4>
                  <i class="fa fa-bed"></i>
                    Bedrooms
                  </h4>
                  <input id="housing_listing_bedrooms" name="housing_listing_bedrooms" class="form-text form-control" type="text">
                </div>
                <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-right: 0px;">
                  <h4>
                  <i class="fa fa-tint"></i>
                    Bathrooms
                  </h4>
                  <input id="housing_listing_bathrooms" name="housing_listing_bathrooms" class="form-text form-control" type="text">
                </div>
              </div>
              <div class="col-xs-12">
                <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                  <h4>
                    <i class="fa fa-building-o"></i>
                    Type
                  </h4>
                  <input id="housing_type_checkbox" name="housing_type_checkbox" type="checkbox">
                </div>
                <div id="form-text-wrapper" class="col-md-6">
                  <h4>
                    <i class="fa fa-bed"></i>
                    Furniture
                  </h4>
                  <input id="furnished_checkbox" name="furnished_checkbox" type="checkbox">
                </div>
              </div>
              <div class="col-xs-12">
                <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                  <h4>
                    <i class="fa fa-wifi"></i>
                    Internet
                  </h4>
                  <input id="internet_checkbox" name="internet_checkbox" type="checkbox">
                </div>
                <div id="form-text-wrapper" class="col-md-6">
                  <h4>
                    <i class="fa fa-car"></i>
                    Parking
                  </h4>
                  <input id="parking_checkbox" name="parking_checkbox" type="checkbox">
                </div>
              </div>
              <div id="more_amenities" style="display:none">
                <div id="" class="col-xs-12">
                  <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                    <h4>
                      Ensuite Washroom
                    </h4>
                    <input id="ensuite_washroom_checkbox" name="ensuite_washroom_checkbox" type="checkbox">
                  </div>
                  <div id="form-text-wrapper" class="col-md-6">
                    <h4>
                      Washer/Dryer
                    </h4>
                    <input id="washer_dryer_checkbox" name="washer_dryer_checkbox" type="checkbox">
                  </div>
                </div>
                <div class="col-xs-12">
                  <div id="form-text-wrapper" class="col-md-6" style="padding-left: 0px;">
                    <h4>
                      Gym
                    </h4>
                    <input id="gym_checkbox" name="gym_checkbox" type="checkbox">
                  </div>
                  <div id="form-text-wrapper" class="col-md-6">
                    <h4>
                      Pet-friendly
                    </h4>
                    <input id="pet_friendly_checkbox" name="pet_friendly_checkbox" type="checkbox">
                  </div>
                </div>
              </div>
              <div class="col-xs-12" style="margin-top: 10px;">
                <button id="more_amenities_btn" class="btn btn-sm btn-success" style="float: right;"><i class="fa fa-plus"></i>
                  <span id="amenities_btn_text">More Amenities</span>
                </button>
              </div>
              <div class="col-md-12" id="form-text-wrapper" style="padding-left: 0px; padding-right: 0px; margin-top: 15px;">
                <h4>
                <i class="fa fa-pencil"></i>
                Details</h4>
                <textarea id="housing_listing_details" name="housing_listing_details" class="form-text-area form-control" rows="5" id="details"></textarea>
              </div>
            </section>
          </section>
        </div>
        <div class="col-md-4">
          <section class='panel'>
            <section class='panel-body'>
              <div id="form-text-wrapper">
                <h4>
                <i class="fa fa-dollar"></i>
                Price</h4>
                <input id="housing_listing_price" name="housing_listing_price" class="form-text form-control" type="text">
              </div>
              <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-left: 0px; margin-top: 13px;">
                <h4>
                <i class="fa fa-clock-o"></i>
                Start Date
                </h4>
                <input id="housing_listing_start_date" name="housing_listing_start_date" class="datepicker form-text-area form-control" data-date-format="mm/dd/yyyy">
              </div>
              <div id="form-text-wrapper" class="col-md-6 col-sm-6 col-xs-6" style="padding-right: 0px; margin-top: 13px;">
                <h4>
                <i class="fa fa-clock-o"></i>
                End Date
                </h4>
                <input id="housing_listing_end_date" name="housing_listing_end_date" class="datepicker form-text-area form-control" data-date-format="mm/dd/yyyy">
              </div>
            </section>
          </section>
        </div>
        <div class="col-md-4 col-sm-12 col-xs-12">
            <section class='panel'>
              <section class='panel-body'>
                <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                  <!-- Indicators -->
                  <ol id="carousel_indicators" class="carousel-indicators">
                  <% i = 0%>
                  <% @housing_listing.housing_images.each do |housing_image| %>
                      <% if housing_image == @housing_listing.housing_images.first%>
                    <li data-target="#carousel-example-generic" data-slide-to="<%=i%>" class="active"></li>
                      <% else %>
                    <li data-target="#carousel-example-generic" data-slide-to="<%=i%>"></li>
                      <% end %>
                      <%i = i + 1%>
                  <% end %>
                  </ol>

                  <!-- Wrapper for slides -->
                  <div id="carousel_inner" class="carousel-inner" role="listbox">
                    <% if @housing_listing.housing_images.length > 0%>
                      <% @housing_listing.housing_images.each do |housing_image| %>
                        <% if housing_image == @housing_listing.housing_images.first%>
                        <div class="item active">
                        <% else %>
                        <div class="item">
                        <% end %>
                          <img src="<%= housing_image.url %>" alt="..." style="width: 100%; height: 275px;"></img>
                          <div class="carousel-caption">
                            <h3><%= housing_image.title %></h3>
                            <p><%= housing_image.description %></p>
                          </div>
                        </div>
                      <% end %>
                    <% else %>
                    <div id="no_photos_available" class="item active">
                      <img alt="..." style="width: 100%; height: 275px;" src="/images/no_photos_available.jpg"></img>
                    </div>
                    <% end %>
                  </div>

                  <!-- Controls -->
                  <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                  </a>
                  <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                  </a>
                </div>

                <button id="upload_photos_btn" class="btn btn-sm btn-success" style="width:100%; margin-top: 1%;">Upload photos</button>
              </section>
            </section>
          </div>

          <%= cl_image_upload_tag(:image_id, :html => {'id' => 'photo_upload_submit_btn', 'style' => 'display: none;'}) %>
      </form>
      <div class="col-md-12" style="text-align:center; padding-bottom: 30px; padding-top: 30px;">
        <button id="submit_btn" class="btn btn-success" style="width: 200px; float: right; margin: 5px;">
          Submit
        </button>
        <button id="cancel_btn" class="btn btn-warning" style="width: 200px; float: right; margin: 5px;">
          Cancel
        </button>
      </div>

  </body>

  <div class="modal fade" id="publish_diag" tabindex="-1" role="dialog" aria-labelledby="publish_diag_title" aria-hidden="true">
      <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="publish_diag_title">Success!</h4>
          </div>
          <div class="modal-body">
          <p>You have successfully made changes to your ad. You can find it at the following <a href="<%=housing_listing_url(@housing_listing.id)%>" target="_blank">link</a></p>
          </div>
          <div class="modal-footer">
          <button id="publish_confirm" type="button" class="btn btn-primary">Got it!</button>
          </div>
      </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
  </div>

  <div class="modal" id="photos_modal" tabindex="-1" role="dialog" aria-labelledby="login_modal" aria-hidden="true">
      <div class="modal-dialog modal-sm">
          <div class="modal-content">
              <div class="modal-header">
                <h4>Upload photo</h4>
              </div>
              <div class="modal-body">
                <div>
                  Title (Optional)
                  <input id="image_title" class="form-text" type="text">
                </div>
                <div>
                  Description (Optional)
                  <textarea id="image_description" class="form-text-area" rows="5" id="photo_details"></textarea>
                </div>
                <div id="custom_photo_upload_submit_btn" class="btn btn-success" style="width: 100%;">
                  Upload photo
                </div>
              </div>
              
          </div>
      </div>
  </div><!-- end of photos_modal -->

</html>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="/assets/bootstrap-switch-master/dist/js/bootstrap-switch.js"></script>
<script src="/assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="/assets/jquery.ui.widget"></script>
<script src="/assets/jquery.iframe-transport"></script>
<script src="/assets/jquery.fileupload"></script>
<script src="/assets/jquery.cloudinary"></script>

    <%= cloudinary_js_config %>
<script type="text/javascript">
  /*
    VARIABLES FOR SCRIPTS
  */

  var housing_listing_is_active = <%=@housing_listing.active%>;
  if (housing_listing_is_active) {

    var is_furnished_active = <%= ((@housing_setting.furnished == nil) ? 0 : @housing_setting.furnished) %>;
    var rental_active_active = '<%=@housing_setting.rental_type%>';
    var internet_active = <%=@housing_setting.internet%>;
    var parking_active = <%=@housing_setting.parking%>;
    var ensuite_washroom_active = <%=@housing_setting.ensuite_washroom%>;
    var washer_dryer_active = <%=@housing_setting.washer_dryer%>;
    var gym_active = <%=@housing_setting.gym%>;
    var pet_friendly_active = <%=@housing_setting.pet_friendly%>;
    var start_date_active = "<%=@housing_setting.start_date%>";
    var end_date_active = "<%=@housing_setting.end_date%>";
    var address_active = "<%=@housing_listing.address%>";
    var title_active = "<%=@housing_listing.name%>";
    var bedrooms_avail_active = "<%=@housing_setting.rooms_available%>";
    var bathrooms_avail_active = "<%=@housing_setting.num_washrooms%>";
    var price_active = "<%=@housing_listing.price%>";
    var details_active = "<%=@housing_listing.description%>";
  }
  var cloudinary_image_new_api = "<%= api_v1_cloudinary_images_url %>";
  var housing_listing_update_api = "<%= api_v1_housing_listing_url %>";
  var current_housing_listing_id = <%= @housing_listing.id %>;
  var dashboard_index = "<%= dashboard_index_url %>"; 

</script>
<%= javascript_include_tag "/javascripts/dashboard_housing_listings_edit" %>
