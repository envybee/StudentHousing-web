<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="/assets/ladda/dist/spin.min.js"></script>
<script src="/assets/spin.js/jquery.spin.js"></script>
<script src="/assets/ladda/dist/ladda.min.js"></script>
<script>

var api_new_housing_listing = "<%= api_v1_housing_listings_url %>";

$("#post_new_place_btn").on("click", function(e) {
	e.preventDefault();

  createNewListing();
});

function createNewListing() {
  var l = Ladda.create( document.querySelector( '#post_new_place_btn' ) );

  $.ajax({
    method: 'post',
    url: api_new_housing_listing,
    beforeSend: function() {
      l.start();
    },
    success: function(response){
      console.log(response);
      window.location.href = response.redirect_url;
    },
    error: function(response) {
      console.log(response);
    },
    complete: function() {
      l.stop();
    }
  });
}


</script>